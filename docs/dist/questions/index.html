<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Frequently Asked Questions | üåêmaptalks.three</title>
    <meta name="description" content="A maptalks layer to render with three.js.">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/maptalks.three/docs/dist/assets/style.Dj9aAfoc.css" as="style">
    <link rel="preload stylesheet" href="/maptalks.three/docs/dist/vp-icons.css" as="style">
    
    <script type="module" src="/maptalks.three/docs/dist/assets/app.BS7L0fYZ.js"></script>
    <link rel="preload" href="/maptalks.three/docs/dist/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/maptalks.three/docs/dist/assets/chunks/theme.DSn-zCsg.js">
    <link rel="modulepreload" href="/maptalks.three/docs/dist/assets/chunks/framework.C7KVE_tj.js">
    <link rel="modulepreload" href="/maptalks.three/docs/dist/assets/questions_index.md.D42nop73.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-039d98f4><!--[--><!--]--><!--[--><span tabindex="-1" data-v-148ee39e></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-148ee39e> Skip to content </a><!--]--><!----><header class="VPNav" data-v-039d98f4 data-v-70d7739d><div class="VPNavBar" data-v-70d7739d data-v-8043b566><div class="wrapper" data-v-8043b566><div class="container" data-v-8043b566><div class="title" data-v-8043b566><div class="VPNavBarTitle" data-v-8043b566 data-v-85ba52d0><a class="title" href="/maptalks.three/docs/dist/" data-v-85ba52d0><!--[--><!--]--><!----><span data-v-85ba52d0>üåêmaptalks.three</span><!--[--><!--]--></a></div></div><div class="content" data-v-8043b566><div class="content-body" data-v-8043b566><!--[--><!--]--><div class="VPNavBarSearch search" data-v-8043b566><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-8043b566 data-v-044a5bdc><span id="main-nav-aria-label" class="visually-hidden" data-v-044a5bdc> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/maptalks.three/docs/dist/start/install.html" tabindex="0" data-v-044a5bdc data-v-21ff0500><!--[--><span data-v-21ff0500>Start</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/maptalks.three/docs/dist/api/index.html" tabindex="0" data-v-044a5bdc data-v-21ff0500><!--[--><span data-v-21ff0500>API</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/maptalks.three/docs/dist/questions/index.html" tabindex="0" data-v-044a5bdc data-v-21ff0500><!--[--><span data-v-21ff0500>Questions</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://maptalks.org/maptalks.three/demo/index.html" target="_blank" rel="noreferrer" tabindex="0" data-v-044a5bdc data-v-21ff0500><!--[--><span data-v-21ff0500>Examples</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-8043b566 data-v-ff4fd8a7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-ff4fd8a7 data-v-74b2a4b7 data-v-23fd7353><span class="check" data-v-23fd7353><span class="icon" data-v-23fd7353><!--[--><span class="vpi-sun sun" data-v-74b2a4b7></span><span class="vpi-moon moon" data-v-74b2a4b7></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-8043b566 data-v-77e126b0 data-v-9d60d05a><!--[--><a class="VPSocialLink no-icon" href="https://github.com/maptalks/maptalks.three" aria-label="github" target="_blank" rel="noopener" data-v-9d60d05a data-v-f8c49d64><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-8043b566 data-v-313c985c data-v-ceef2422><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-ceef2422><span class="vpi-more-horizontal icon" data-v-ceef2422></span></button><div class="menu" data-v-ceef2422><div class="VPMenu" data-v-ceef2422 data-v-d0227bef><!----><!--[--><!--[--><!----><div class="group" data-v-313c985c><div class="item appearance" data-v-313c985c><p class="label" data-v-313c985c>Appearance</p><div class="appearance-action" data-v-313c985c><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-313c985c data-v-74b2a4b7 data-v-23fd7353><span class="check" data-v-23fd7353><span class="icon" data-v-23fd7353><!--[--><span class="vpi-sun sun" data-v-74b2a4b7></span><span class="vpi-moon moon" data-v-74b2a4b7></span><!--]--></span></span></button></div></div></div><div class="group" data-v-313c985c><div class="item social-links" data-v-313c985c><div class="VPSocialLinks social-links-list" data-v-313c985c data-v-9d60d05a><!--[--><a class="VPSocialLink no-icon" href="https://github.com/maptalks/maptalks.three" aria-label="github" target="_blank" rel="noopener" data-v-9d60d05a data-v-f8c49d64><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-8043b566 data-v-29fd3555><span class="container" data-v-29fd3555><span class="top" data-v-29fd3555></span><span class="middle" data-v-29fd3555></span><span class="bottom" data-v-29fd3555></span></span></button></div></div></div></div><div class="divider" data-v-8043b566><div class="divider-line" data-v-8043b566></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-039d98f4 data-v-3c64a258><div class="container" data-v-3c64a258><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-3c64a258 data-v-8d0cc947><button data-v-8d0cc947>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-039d98f4 data-v-af981b47><div class="VPDoc has-aside" data-v-af981b47 data-v-ca6a45ed><!--[--><!--]--><div class="container" data-v-ca6a45ed><div class="aside" data-v-ca6a45ed><div class="aside-curtain" data-v-ca6a45ed></div><div class="aside-container" data-v-ca6a45ed><div class="aside-content" data-v-ca6a45ed><div class="VPDocAside" data-v-ca6a45ed data-v-a495cd0b><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-a495cd0b data-v-4f9b9e0e><div class="content" data-v-4f9b9e0e><div class="outline-marker" data-v-4f9b9e0e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-4f9b9e0e>On this page</div><ul class="VPDocOutlineItem root" data-v-4f9b9e0e data-v-a6280b96><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-a495cd0b></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-ca6a45ed><div class="content-container" data-v-ca6a45ed><!--[--><!--]--><main class="main" data-v-ca6a45ed><div style="position:relative;" class="vp-doc _maptalks_three_docs_dist_questions_" data-v-ca6a45ed><div><h1 id="frequently-asked-questions" tabindex="-1">Frequently Asked Questions <a class="header-anchor" href="#frequently-asked-questions" aria-label="Permalink to &quot;Frequently Asked Questions&quot;">‚Äã</a></h1><p>Answers to common user questions</p><h2 id="maptalks-gl" tabindex="-1">maptalks-gl? <a class="header-anchor" href="#maptalks-gl" aria-label="Permalink to &quot;maptalks-gl?&quot;">‚Äã</a></h2><p>The WebGL version of Maptalks is currently under development and will be released soon</p><h2 id="how-to-control-the-camera" tabindex="-1">How to control the camera <a class="header-anchor" href="#how-to-control-the-camera" aria-label="Permalink to &quot;How to control the camera&quot;">‚Äã</a></h2><p>When using the maptalks.tree plugin, due to the influence of Threejs, I always think about operating the camera in the ThreeLayer layer to control the map. This is not correct because ThreeLayer is just one layer, and there can be multiple layers on a map. If a layer can control the view angle of the map, then multiple layers simultaneously operating the camera view angle of the map will cause the map to receive multiple instructions to change the view angle, leading to confusion</p><p>The cameras in ThreeLayer are only used to synchronize the cameras in the map</p><ul><li><p>The camera is a global feature with map object control</p></li><li><p>All layers are map driven, and there is no possibility of using layers to control the map because there are multiple layers on the map. If layers can control the map, the map will become chaotic</p></li><li><p>Layers should only control their internal affairs, such as whether the graphics in the layer can be clicked, the display and hiding of the layer, clearing the data in the layer, enabling animation in the layer, and controlling the animation of graphics inside the layer</p></li></ul><p>We should start with the map</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">map.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setCenter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(center);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//or</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">map.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//or</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">map.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">animateTo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(view, {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h2 id="initialize-theelayer-layer-error" tabindex="-1">Initialize TheeLayer layer error <a class="header-anchor" href="#initialize-theelayer-layer-error" aria-label="Permalink to &quot;Initialize TheeLayer layer error&quot;">‚Äã</a></h2><p>The initialization of TheeLayer is asynchronous, so business operations need to be performed in the <code>prepareToDraw</code> method of Threelayer</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // the ThreeLayer to draw buildings</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> threeLayer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> maptalks.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ThreeLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;t&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      forceRenderOnMoving: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      forceRenderOnRotating: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      identifyCountOnEvent: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // animation: true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  threeLayer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepareToDraw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">gl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scene</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">camera</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      //do some things</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sceneConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      postProcess: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          enable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          antialias: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              enable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> groupLayer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> maptalks.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GroupGLLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;group&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [threeLayer], {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      sceneConfig</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  groupLayer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addTo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(map);</span></span></code></pre></div><h2 id="after-upgrading-to-three-the-program-became-abnormal" tabindex="-1">After upgrading to three, the program became abnormal <a class="header-anchor" href="#after-upgrading-to-three-the-program-became-abnormal" aria-label="Permalink to &quot;After upgrading to three, the program became abnormal&quot;">‚Äã</a></h2><p>This is because the compatibility of the three version iteration is very poor, and there will be many destructive updates during the three version upgrade</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>When using three, remember not to upgrade versions casually. It is best to upgrade them centrally, such as every six months or a year, instead of upgrading every time three releases a version. Currently, it seems that every version upgrade of three will make a lot of destructive updates</p></div><h2 id="the-issue-of-inheriting-classes-from-prototypes" tabindex="-1">The issue of inheriting classes from prototypes <a class="header-anchor" href="#the-issue-of-inheriting-classes-from-prototypes" aria-label="Permalink to &quot;The issue of inheriting classes from prototypes&quot;">‚Äã</a></h2><p><img src="/maptalks.three/docs/dist/4.png" alt="" loading="lazy"></p><p>This is all caused by using the Three plugin, but the plugin is older and you used a higher version of Three. The new version of Three is packaged as ES6 by default, but the old plugin still uses the prototype method for inheritance. However, ES specification class prototypes cannot inherit classes. Therefore, please maintain consistency between Three and its plugin version when using it</p><h2 id="the-various-post-processing-of-three-is-not-effective-or-does-not-achieve-the-expected-effect" tabindex="-1">The various post-processing of three is not effective or does not achieve the expected effect <a class="header-anchor" href="#the-various-post-processing-of-three-is-not-effective-or-does-not-achieve-the-expected-effect" aria-label="Permalink to &quot;The various post-processing of three is not effective or does not achieve the expected effect&quot;">‚Äã</a></h2><p>The webglcontext in the three plugin is provided by GroupGLLayer by default, and the entire webglcontext is controlled by GroupGLLayer. If the post-processing of three is used, it will change the state of webglcontext, which may conflict with the operations on webglcontext in GroupGLLayer and cause some unknown problems</p><p>GroupGLLayer provides some post-processing functions by default. If you need post-processing effects, you should start with GroupGLLayer, such as bloom, shadow, ssao, etc</p><h2 id="the-model-picking-performance-is-relatively-poor" tabindex="-1">The model picking performance is relatively poor <a class="header-anchor" href="#the-model-picking-performance-is-relatively-poor" aria-label="Permalink to &quot;The model picking performance is relatively poor&quot;">‚Äã</a></h2><p>The picking of models (gltf, obj, fbx, etc.) in the three plugin still uses raycaster. However, when the model becomes larger and more complex, there may be performance issues. You can use the three bvh plugin to speed it up. I tried it and the performance improvement was still very good</p><p><a href="https://github.com/gkjohnson/three-mesh-bvh" target="_blank" rel="noreferrer">three-mesh-bvh</a></p><h2 id="the-graphics-added-to-the-layer-need-to-be-manually-moved-on-the-map-to-be-rendered" tabindex="-1">The graphics added to the layer need to be manually moved on the map to be rendered <a class="header-anchor" href="#the-graphics-added-to-the-layer-need-to-be-manually-moved-on-the-map-to-be-rendered" aria-label="Permalink to &quot;The graphics added to the layer need to be manually moved on the map to be rendered&quot;">‚Äã</a></h2><p>Threelayer still uses the same rendering mechanism as Three internally, which requires activating the animation rendering function of the layer for real-time rendering</p><ul><li>Manually control animation functions by oneself</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> animation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // layer animation support Skipping frames</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    threeLayer._needsUpdate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">threeLayer._needsUpdate;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (threeLayer._needsUpdate) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        threeLayer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redraw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    stats.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    requestAnimationFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(animation);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>Or enable the animation function option for the layer</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> threeLayer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> maptalks.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ThreeLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;t&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    forceRenderOnMoving: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    forceRenderOnRotating: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    identifyCountOnEvent: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    animation: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h2 id="the-native-object-3d-of-three-will-automatically-bloom-when-directly-added-to-the-threelayer" tabindex="-1">The native Object 3D of three will automatically bloom when directly added to the ThreeLayer <a class="header-anchor" href="#the-native-object-3d-of-three-will-automatically-bloom-when-directly-added-to-the-threelayer" aria-label="Permalink to &quot;The native Object 3D of three will automatically bloom when directly added to the ThreeLayer&quot;">‚Äã</a></h2><p>The graphics in ThreeLayer are divided into two types:</p><ul><li>Based on BaseObject</li><li>Three Native Object 3D</li></ul><p>The native Object 3D of three is added to ThreeLayer, and ThreeLayer will also render, but it will be separated from ThreeLayer&#39;s global management:</p><ul><li>event control</li><li>bloom control</li></ul><p>It is recommended to construct graphics based on BaseObject, even if it is three&#39;s native Object 3D, it should be wrapped in BaseObject</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//default values</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> OPTIONS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    altitude: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//https://zhuanlan.zhihu.com/p/199353080</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XXX</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> maptalks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BaseObject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mesh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">material</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">layer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        options </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> maptalks.Util.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">extend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OPTIONS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, options, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            layer</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        //Initialize internal configuration</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // https://github.com/maptalks/maptalks.three/blob/1e45f5238f500225ada1deb09b8bab18c1b52cf2/src/BaseObject.js#L135</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_initOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(options);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_createGroup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getObject3d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mesh);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        //Initialize internal object3d</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // https://github.com/maptalks/maptalks.three/blob/1e45f5238f500225ada1deb09b8bab18c1b52cf2/src/BaseObject.js#L140</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        //set object3d position</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getObject3d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().position.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mesh.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getObject3d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().position);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>If it&#39;s a model, ThreeLayer comes with a built-in method</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">baseObjectModel </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> threeLayer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    coordinate: map.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getCenter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-ca6a45ed data-v-cebe99ab><!--[--><!--]--><div class="edit-info" data-v-cebe99ab><!----><div class="last-updated" data-v-cebe99ab><p class="VPLastUpdated" data-v-cebe99ab data-v-1670a9c3>Last updated: <time datetime="2025-01-15T03:12:18.000Z" data-v-1670a9c3></time></p></div></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_baseobject.md\":\"ClRSHmS4\",\"api_index.md\":\"BYyICOA8\",\"api_threelayer.md\":\"CLLoHpAM\",\"api_types.md\":\"BpJ3OtuL\",\"index.md\":\"Cvp-nnnj\",\"questions_index.md\":\"D42nop73\",\"start_custom.md\":\"DXusqSQm\",\"start_helloworld.md\":\"C4t00qqH\",\"start_install.md\":\"DJwzgDoQ\",\"start_links.md\":\"BYlvTVrf\",\"start_target.md\":\"DmTeVfOC\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"üåêmaptalks.three\",\"description\":\"A maptalks layer to render with three.js.\",\"base\":\"/maptalks.three/docs/dist/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Start\",\"link\":\"/start/install.md\",\"activeMatch\":\"/start/\"},{\"text\":\"API\",\"link\":\"/api/index.md\",\"activeMatch\":\"/api/\"},{\"text\":\"Questions\",\"link\":\"/questions/index.md\",\"activeMatch\":\"/questions/\"},{\"text\":\"Examples\",\"link\":\"https://maptalks.org/maptalks.three/demo/index.html\"}],\"sidebar\":{\"/start/\":[{\"text\":\"Install\",\"link\":\"/start/install.md\"},{\"text\":\"Hello World\",\"link\":\"/start/helloworld.md\"},{\"text\":\"Design Target\",\"link\":\"/start/target.md\"},{\"text\":\"Custom BaseObject\",\"link\":\"/start/custom.md\"},{\"text\":\"Some Links\",\"link\":\"/start/links.md\"}],\"/api/\":[{\"text\":\"Some Types\",\"link\":\"/api/types.md\"},{\"text\":\"BaseObject\",\"link\":\"/api/baseobject.md\"},{\"text\":\"ThreeLayer\",\"link\":\"/api/threelayer.md\"}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/maptalks/maptalks.three\"}],\"lastUpdated\":true,\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>