// eslint-disable-next-line quotes
const workerCode = `(function(e){"use strict";var t={exports:{}};function r(e,t,r){r=r||2;var o,v,h,u,s,x,p,d=t&&t.length,g=d?t[0]*r:e.length,y=n(e,0,g,r,!0),m=[];if(!y||y.next===y.prev)return m;if(d&&(y=function(e,t,r,a){var o,v,h,u=[];for(o=0,v=t.length;o<v;o++)(h=n(e,t[o]*a,o<v-1?t[o+1]*a:e.length,a,!1))===h.next&&(h.steiner=!0),u.push(c(h));for(u.sort(l),o=0;o<u.length;o++)f(u[o],r),r=i(r,r.next);return r}(e,t,y,r)),e.length>80*r){o=h=e[0],v=u=e[1];for(var M=r;M<g;M+=r)(s=e[M])<o&&(o=s),(x=e[M+1])<v&&(v=x),s>h&&(h=s),x>u&&(u=x);p=0!==(p=Math.max(h-o,u-v))?1/p:0}return a(y,m,r,o,v,p),m}function n(e,t,r,n,i){var a,o;if(i===F(e,t,r,n)>0)for(a=t;a<r;a+=n)o=Z(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=Z(a,e[a],e[a+1],o);return o&&y(o,o.next)&&(A(o),o=o.next),o}function i(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!y(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(A(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function a(e,t,r,n,l,f,s){if(e){!s&&f&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=x(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,a,o,v,h,u=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,v=0,t=0;t<u&&(v++,n=n.nextZ);t++);for(h=u;v>0||h>0&&n;)0!==v&&(0===h||!n||r.z<=n.z)?(i=r,r=r.nextZ,v--):(i=n,n=n.nextZ,h--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,u*=2}while(o>1)}(i)}(e,n,l,f);for(var c,p,d=e;e.prev!==e.next;)if(c=e.prev,p=e.next,f?v(e,n,l,f):o(e))t.push(c.i/r),t.push(e.i/r),t.push(p.i/r),A(e),e=p.next,d=p.next;else if((e=p)===d){s?1===s?a(e=h(i(e),t,r),t,r,n,l,f,2):2===s&&u(e,t,r,n,l,f):a(i(e),t,r,n,l,f,1);break}}}function o(e){var t=e.prev,r=e,n=e.next;if(g(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(p(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function v(e,t,r,n){var i=e.prev,a=e,o=e.next;if(g(i,a,o)>=0)return!1;for(var v=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,h=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,u=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,l=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,f=x(v,h,t,r,n),s=x(u,l,t,r,n),c=e.prevZ,d=e.nextZ;c&&c.z>=f&&d&&d.z<=s;){if(c!==e.prev&&c!==e.next&&p(i.x,i.y,a.x,a.y,o.x,o.y,c.x,c.y)&&g(c.prev,c,c.next)>=0)return!1;if(c=c.prevZ,d!==e.prev&&d!==e.next&&p(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;c&&c.z>=f;){if(c!==e.prev&&c!==e.next&&p(i.x,i.y,a.x,a.y,o.x,o.y,c.x,c.y)&&g(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;d&&d.z<=s;){if(d!==e.prev&&d!==e.next&&p(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function h(e,t,r){var n=e;do{var a=n.prev,o=n.next.next;!y(a,o)&&m(a,n,n.next,o)&&w(a,o)&&w(o,a)&&(t.push(a.i/r),t.push(n.i/r),t.push(o.i/r),A(n),A(n.next),n=e=o),n=n.next}while(n!==e);return i(n)}function u(e,t,r,n,o,v){var h=e;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&d(h,u)){var l=S(h,u);return h=i(h,h.next),l=i(l,l.next),a(h,t,r,n,o,v),void a(l,t,r,n,o,v)}u=u.next}h=h.next}while(h!==e)}function l(e,t){return e.x-t.x}function f(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var v=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(v<=i&&v>o){if(o=v,v===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r;var h,u=r,l=r.x,f=r.y,x=1/0;n=r;do{i>=n.x&&n.x>=l&&i!==n.x&&p(a<f?i:o,a,l,f,a<f?o:i,a,n.x,n.y)&&(h=Math.abs(a-n.y)/(i-n.x),w(n,e)&&(h<x||h===x&&(n.x>r.x||n.x===r.x&&s(r,n)))&&(r=n,x=h)),n=n.next}while(n!==u);return r}(e,t)){var r=S(t,e);i(t,t.next),i(r,r.next)}}function s(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function x(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function c(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function p(e,t,r,n,i,a,o,v){return(i-o)*(t-v)-(e-o)*(a-v)>=0&&(e-o)*(n-v)-(r-o)*(t-v)>=0&&(r-o)*(a-v)-(i-o)*(n-v)>=0}function d(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&m(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(w(e,t)&&w(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||y(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function m(e,t,r,n){var i=b(g(e,t,r)),a=b(g(e,t,n)),o=b(g(r,n,e)),v=b(g(r,n,t));return i!==a&&o!==v||(!(0!==i||!M(e,r,t))||(!(0!==a||!M(e,n,t))||(!(0!==o||!M(r,e,n))||!(0!==v||!M(r,t,n)))))}function M(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function b(e){return e>0?1:e<0?-1:0}function w(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function S(e,t){var r=new z(e.i,e.x,e.y),n=new z(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Z(e,t,r,n){var i=new z(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function z(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function F(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}t.exports=r,t.exports.default=r,r.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs(F(e,0,a,r));if(i)for(var v=0,h=t.length;v<h;v++){var u=t[v]*r,l=v<h-1?t[v+1]*r:e.length;o-=Math.abs(F(e,u,l,r))}var f=0;for(v=0;v<n.length;v+=3){var s=n[v]*r,x=n[v+1]*r,c=n[v+2]*r;f+=Math.abs((e[s]-e[c])*(e[x+1]-e[s+1])-(e[s]-e[x])*(e[c+1]-e[s+1]))}return 0===o&&0===f?0:Math.abs((f-o)/o)},r.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r};var R=t.exports;function q(e,t,r){var n=t[0],i=t[1],a=r[0]-n,o=r[1]-i;if(0!==a||0!==o){var v=((e[0]-n)*a+(e[1]-i)*o)/(a*a+o*o);v>1?(n=r[0],i=r[1]):v>0&&(n+=a*v,i+=o*v)}return(a=e[0]-n)*a+(o=e[1]-i)*o}function P(e,t,r,n,i){for(var a,o=n,v=t+1;v<r;v++){var h=q(e[v],e[t],e[r]);h>o&&(a=v,o=h)}o>n&&(a-t>1&&P(e,t,a,n,i),i.push(e[a]),r-a>1&&P(e,a,r,n,i))}function L(e,t){var r=e.length-1,n=[e[0]];return P(e,0,r,t,n),n.push(e[r]),n}function V(e,t,r){if(e.length<=2)return e;var n=void 0!==t?t*t:1;return e=L(e=r?e:function(e,t){for(var r,n,i,a,o,v=e[0],h=[v],u=1,l=e.length;u<l;u++)r=e[u],i=v,a=void 0,o=void 0,a=(n=r)[0]-i[0],o=n[1]-i[1],a*a+o*o>t&&(h.push(r),v=r);return v!==r&&h.push(r),h}(e,n),n)}function B(e,t){return e[0]*t[0]+e[1]*t[1]}function E(e,t){var r=t[0],n=t[1],i=Math.sqrt(r*r+n*n);return e[0]=r/i,e[1]=n/i,e}function U(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function H(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function I(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function O(e,t){var r=t[0],n=t[1],i=t[2],a=Math.sqrt(r*r+n*n+i*i);return e[0]=r/a,e[1]=n/a,e[2]=i/a,e}function T(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],v=r[1],h=r[2];return e[0]=i*h-a*v,e[1]=a*o-n*h,e[2]=n*v-i*o,e}var W=[];function j(e,t,r,n){var i=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}(t,r),a=Math.acos(i)*n;return U(W,r,t,-i),function(e,t){var r=t[0],n=t[1],i=t[2],a=Math.sqrt(r*r+n*n+i*i);e[0]=r/a,e[1]=n/a,e[2]=i/a}(W,W),function(e,t,r){e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r}(e,t,Math.cos(a)),U(e,e,W,Math.sin(a)),e}function k(e,t,r,n,i,a,o,v,h,u){var l=o-i,f=v-a,s=(l*(t-a)-f*(e-i))/(f*(r-e)-l*(n-t));return h&&(h[u=u||0]=e+s*(r-e),h[u+1]=t+s*(n-t)),s}function _(e,t,r){if(r-t<3)return 0;for(var n=0,i=2*(r-1),a=2*t;a<2*r;){var o=e[i],v=e[i+1],h=e[a],u=e[a+1];i=a,a+=2,n+=o*u-h*v}return n}function D(e,t,r){return void 0===r&&(r=2),R(e,t,r)}var C=[],G=[],J=[];function K(e,t,r,n,i,a,o,v,h){var u,l,f,s=null!=o,x=i,c=null;s&&(c=new Uint32Array(n-r));for(var p=[],d=r;d<n;d++){var g=d===n-1?r:d+1,y=d===r?n-1:d-1,m=e[2*y],M=e[2*y+1],b=e[2*d],w=e[2*d+1],S=e[2*g],Z=e[2*g+1];C[0]=b-m,C[1]=w-M,G[0]=S-b,G[1]=Z-w,E(C,C),E(G,G),s&&(c[d]=x);var A=!1,z=void 0,F=void 0;if(v||d!==r)if(v||d!==n-1){H(J,G,C);var R=J[1];J[1]=-J[0],J[0]=R,E(J,J);var q=B(J,G),P=Math.sqrt(1-q*q),L=a*Math.min(10,1/P);if(s&&1/P>o&&a*q<0){var V=b+J[0]*a,U=w+J[1]*a,I=Math.acos(P)/2,O=Math.tan(I)*Math.abs(a);t[2*x]=V+J[1]*O,t[2*x+1]=U-J[0]*O,t[2*++x]=V-J[1]*O,t[2*x+1]=U+J[0]*O,x++}else z=b+J[0]*L,F=w+J[1]*L,A=!0;if(A){if(h&&null!=u){var T=k(m,M,u,l,b,w,z,F,p,0);T>=-.01&&T<=1.01&&(t[2*f]=z=p[0],t[2*f+1]=F=p[1])}u=t[2*x]=z,l=t[2*x+1]=F,f=x,x++}}else J[0]=C[1],J[1]=-C[0],E(J,J),z=b+J[0]*a,F=w+J[1]*a,A=!0;else J[0]=G[1],J[1]=-G[0],E(J,J),u=t[2*x]=b+J[0]*a,l=t[2*x+1]=w+J[1]*a,f=x,x++}return c}function N(e,t,r,n,i,a,o,v){var h=null!=o,u=i,l=null;h&&(l=new Uint32Array(n-r));for(var f=r;f<n;f++){var s=f===n-1?r:f+1,x=f===r?n-1:f-1,c=e[2*x],p=e[2*x+1],d=e[2*f],g=e[2*f+1],y=e[2*s],m=e[2*s+1];if(C[0]=d-c,C[1]=g-p,G[0]=y-d,G[1]=m-g,E(C,C),E(G,G),h&&(l[f]=u),v||f!==r)if(v||f!==n-1){H(J,G,C);var M=J[1];J[1]=-J[0],J[0]=M,E(J,J);var b=B(J,G),w=Math.sqrt(1-b*b),S=a*Math.min(10,1/w);if(h&&1/w>o&&a*b<0){var Z=d+J[0]*a,A=g+J[1]*a,z=Math.acos(w)/2,F=Math.tan(z)*Math.abs(a);t[2*u]=Z+J[1]*F,t[2*u+1]=A-J[0]*F,t[2*++u]=Z-J[1]*F,t[2*u+1]=A+J[0]*F,u++}else t[2*u]=d+J[0]*S,t[2*u+1]=g+J[1]*S,u++}else J[0]=C[1],J[1]=-C[0],E(J,J),t[2*u]=d+J[0]*a,t[2*u+1]=g+J[1]*a,u++;else J[0]=G[1],J[1]=-G[0],E(J,J),t[2*u]=d+J[0]*a,t[2*u+1]=g+J[1]*a,u++}return l}function Q(e,t,r,n,i){var a=null!=n?[]:new Float32Array(e.length);if(K(e,a,0,t&&t.length?t[0]:e.length/2,0,r,n,i,!0),t)for(var o=0;o<t.length;o++){var v=t[o];K(e,a,v,t[o+1]||e.length/2,null!=n?a.length/2:v,r,n,i,!1)}return a}function X(e,t,r,n){for(var i=0;i<Math.floor((n-r)/2);i++)for(var a=0;a<t;a++){var o=(i+r)*t+a,v=(n-i-1)*t+a,h=e[o];e[o]=e[v],e[v]=h}return e}function Y(e,t){var r=e.length/2,n=0,i=t&&t.length?t[0]:r;_(e,n,i)>0&&X(e,2,n,i);for(var a=1;a<(t?t.length:0)+1;a++)_(e,n=t[a-1],i=t[a]||r)<0&&X(e,2,n,i)}function $(e){e.depth=e.depth||1,e.bevelSize=e.bevelSize||0,e.bevelSegments=null==e.bevelSegments?2:e.bevelSegments,e.smoothBevel=e.smoothBevel||!1,e.simplify=e.simplify||0,null==e.smoothSide&&(e.smoothSide="auto"),null==e.smoothSideThreshold&&(e.smoothSideThreshold=.9),"number"==typeof e.depth&&(e.bevelSize=Math.min(e.bevelSegments>0?e.bevelSize:0,e.depth/2)),e.bevelSize>0||(e.bevelSegments=0),e.bevelSegments=Math.round(e.bevelSegments);var t=e.boundingRect;if(e.translate=e.translate||[0,0],e.scale=e.scale||[1,1],e.fitRect){var r=null==e.fitRect.x?t.x||0:e.fitRect.x,n=null==e.fitRect.y?t.y||0:e.fitRect.y,i=e.fitRect.width,a=e.fitRect.height;null==i?null!=a?i=a/t.height*t.width:(i=t.width,a=t.height):null==a&&(a=i/t.width*t.height),e.scale=[i/t.width,a/t.height],e.translate=[(r-t.x)*e.scale[0],(n-t.y)*e.scale[1]]}}var ee=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]];function te(e,t,r){for(var n=0,i=e[t],a=e[t+1],o=i,v=a,h=t+2;h<r;h+=2){var u=e[h],l=e[h+1];n+=Math.sqrt((u-i)*(u-i)+(l-a)*(l-a)),i=u,a=l}return n+=Math.sqrt((i-o)*(i-o)+(a-v)*(a-v))}function re(e,t,r,n,i,a){var o=t.vertices,v=t.topVertices,h=t.splittedMap,u=t.depth,l=t.rect,f=n-r,s=a.smoothBevel?1:2,x=Math.min(u/2,a.bevelSize),c=a.bevelSegments,p=i.vertex,d=i.ringPerimeter,g=Math.max(l.width,l.height,u,d);function y(e){var t=(e+1)%f,r=o[2*e],n=o[2*e+1],i=o[2*t],a=o[2*t+1];return r===i&&n===a}if(x>0)for(var m=[0,0,1],M=[],b=[0,0,-1],w=[],S=0,Z=new Float32Array(f),A=0;A<2;A++)for(var z=0===A?u-x:x,F=0;F<=c*s;F++){for(var R=0,q=void 0,P=void 0,L=0;L<f;L++){var V=2*(L%f+r),B=h?2*h[V/2]:V;M[0]=o[V]-v[B],M[1]=o[V+1]-v[B+1],M[2]=0;var E=Math.sqrt(M[0]*M[0]+M[1]*M[1]);M[0]/=E,M[1]/=E;var U=(Math.floor(F/s)+F%s)/c;0===A?j(w,m,M,U):j(w,M,b,U);var H=0===A?U:1-U,I=x*Math.sin(H*Math.PI/2),O=E*Math.cos(H*Math.PI/2),T=x*E/Math.sqrt(I*I+O*O),W=w[0]*T+v[B],k=w[1]*T+v[B+1],_=w[2]*T+z;if(e.position[3*i.vertex]=W,e.position[3*i.vertex+1]=k,e.position[3*i.vertex+2]=_,L>0&&(R+=Math.sqrt((q-W)*(q-W)+(P-k)*(P-k))),F>0||A>0){var D=3*(i.vertex-f),C=e.position[D],G=e.position[D+1],J=e.position[D+2];Z[L]+=Math.sqrt((C-W)*(C-W)+(G-k)*(G-k)+(J-_)*(J-_))}if(e.uv[2*i.vertex]=R/g,e.uv[2*i.vertex+1]=Z[L]/g,q=W,P=k,i.vertex++,!y(L)&&(s>1&&F%s||1===s&&F>=1))for(var K=0;K<6;K++){var N=(ee[K][0]+L)%f,Q=ee[K][1]+S;e.indices[i.index++]=(Q-1)*f+N+p}}S++}else for(var X=0;X<2;X++)for(var Y=0===X?u-x:x,$=0,te=void 0,re=void 0,ne=0;ne<f;ne++){var ie=2*(ne%f+r),ae=o[ie],oe=o[ie+1];e.position[3*i.vertex]=ae,e.position[3*i.vertex+1]=oe,e.position[3*i.vertex+2]=Y,ne>0&&($+=Math.sqrt((te-ae)*(te-ae)+(re-oe)*(re-oe))),e.uv[2*i.vertex]=$/g,e.uv[2*i.vertex+1]=Y/g,te=ae,re=oe,i.vertex++}for(var ve=x>0?c*s+1:1,he=0;he<f;he++)if(!y(he))for(var ue=0;ue<6;ue++){var le=(ee[ue][0]+he)%f,fe=ee[ue][1]+ve;e.indices[i.index++]=(fe-1)*f+le+p}}function ne(e,t,r,n){var i=e.indices,a=e.topVertices,o=e.rect,v=e.depth;if(!(a.length<=4)){for(var h=r.vertex,u=i.length,l=0;l<u;l++)t.indices[r.index++]=h+i[l];for(var f=Math.max(o.width,o.height),s=0;s<(n.excludeBottom?1:2);s++)for(var x=0;x<a.length;x+=2){var c=a[x],p=a[x+1];t.position[3*r.vertex]=c,t.position[3*r.vertex+1]=p,t.position[3*r.vertex+2]=(1-s)*v,t.uv[2*r.vertex]=(c-o.x)/f,t.uv[2*r.vertex+1]=(p-o.y)/f,r.vertex++}if(!n.excludeBottom)for(var d=a.length/2,g=0;g<u;g+=3)for(var y=0;y<3;y++)t.indices[r.index++]=h+d+i[g+2-y]}}function ie(e,t,r,n){var i=null==r||"auto"===r;if(!0===r)return{vertices:e,holes:t};for(var a=[],o=t&&[],v=e.length/2,h=[],u=[],l=[],f=0,s=0,x=(t?t.length:0)+1,c=0;c<x;c++){0===c?s=t&&t.length?t[0]:v:(f=t[c-1],s=t[c]||v);for(var p=f;p<s;p++){var d=e[2*p],g=e[2*p+1],y=p===s-1?f:p+1,m=e[2*y],M=e[2*y+1];if(i){var b=p===f?s-1:p-1,w=e[2*b],S=e[2*b+1];h[0]=w-d,h[1]=S-g,u[0]=m-d,u[1]=M-g,E(h,h),E(u,u),1-(.5*B(h,u)+.5)>n?(a.push(d,g),l.push(p)):(a.push(d,g,d,g),l.push(p,p))}else a.push(d,g,d,g),l.push(p,p)}c<x-1&&o&&o.push(a.length/2)}return{vertices:new Float32Array(a),splittedMap:l,holes:o}}function ae(e,t){for(var r=0,n=0,i=0;i<e.length;i++){var a=e[i],o=a.indices,v=a.vertices,h=a.splittedMap,u=a.topVertices,l=a.depth,f=Math.min(l/2,t.bevelSize)>0?t.bevelSegments:0,s=e[i].holes||[];r+=o.length*(t.excludeBottom?1:2),n+=u.length/2*(t.excludeBottom?1:2);for(var x=2+2*f,c=0,p=0,d=0;d<s.length+1;d++){0===d?p=s.length?s[0]:v.length/2:(c=s[d-1],p=s[d]||v.length/2),r+=6*((h?h[p-1]+1:p)-(h?h[c]:c))*(x-1);var g=p-c;n+=g*x+(t.smoothBevel?0:f*g*2)}}for(var y={position:new Float32Array(3*n),indices:new(n>65535?Uint32Array:Uint16Array)(r),uv:new Float32Array(2*n)},m={vertex:0,index:0,ringPerimeter:0},M=0;M<e.length;M++)ne(e[M],y,m,t);for(var b=0;b<e.length;b++){var w=e[b],S=w.holes,Z=w.vertices.length/2,A=0,z=S&&S.length?S[0]:Z;if(m.ringPerimeter=te(e[b].topVertices,A,z),re(y,e[b],A,z,m,t),S)for(var F=0;F<S.length;F++)A=S[F],z=S[F+1]||Z,m.ringPerimeter=te(e[b].topVertices,A,z),re(y,e[b],A,z,m,t)}for(var R=0;R<y.uv.length;R++){var q=y.uv[R];q>0&&Math.round(q)===q?y.uv[R]=1:y.uv[R]=q%1}return y.normal=function(e,t){function r(e,t,r,n){e[0]=t,e[1]=r,e[2]=n}for(var n=[],i=[],a=[],o=[],v=[],h=[],u=e.length,l=new Float32Array(t.length),f=0;f<u;){var s=3*e[f++],x=3*e[f++],c=3*e[f++];r(n,t[s],t[s+1],t[s+2]),r(i,t[x],t[x+1],t[x+2]),r(a,t[c],t[c+1],t[c+2]),I(o,n,i),I(v,i,a),T(h,o,v);for(var p=0;p<3;p++)l[s+p]=l[s+p]+h[p],l[x+p]=l[x+p]+h[p],l[c+p]=l[c+p]+h[p]}for(var d=0;d<l.length;)r(h,l[d],l[d+1],l[d+2]),O(h,h),l[d++]=h[0],l[d++]=h[1],l[d++]=h[2];return l}(y.indices,y.position),y.boundingRect=e[0]&&e[0].rect,y}function oe(e,t,r){for(var n=r.lineWidth,i=e.length,a=new Float32Array(2*i),o=r.translate||[0,0],v=r.scale||[1,1],h=0,u=0;h<i;h++)a[u++]=e[h][0]*v[0]+o[0],a[u++]=e[h][1]*v[1]+o[1];_(a,0,i)<0&&X(a,2,0,i);var l=[],f=[],s=r.miterLimit,x=N(a,f,0,i,0,-n/2,s,!1);X(a,2,0,i);for(var c=N(a,l,0,i,0,-n/2,s,!1),p=(l.length+f.length)/2,d=new Float32Array(2*p),g=0,y=f.length/2,m=0;m<f.length;m++)d[g++]=f[m];for(var M=0;M<l.length;M++)d[g++]=l[M];for(var b=new(p>65535?Uint32Array:Uint16Array)(3*(2*(i-1)+(p-2*i))),w=0,S=0;S<i-1;S++){var Z=S+1;b[w++]=y-1-x[S],b[w++]=y-1-x[S]-1,b[w++]=c[S]+1+y,b[w++]=y-1-x[S],b[w++]=c[S]+1+y,b[w++]=c[S]+y,c[Z]-c[S]==2?(b[w++]=c[S]+2+y,b[w++]=c[S]+1+y,b[w++]=y-x[Z]-1):x[Z]-x[S]==2&&(b[w++]=c[Z]+y,b[w++]=y-1-(x[S]+1),b[w++]=y-1-(x[S]+2))}var A=r.bevelSize>0?Q(d,[],r.bevelSize,null,!0):d,z=r.boundingRect,F=ie(d,null,r.smoothSide,r.smoothSideThreshold);return{vertices:F.vertices,rawVertices:A,splittedMap:F.splittedMap,indices:b,topVertices:A,rect:{x:z.x*v[0]+o[0],y:z.y*v[1]+o[1],width:z.width*v[0],height:z.height*v[1]},depth:"function"==typeof r.depth?r.depth(t):r.depth,holes:[]}}function ve(e,t){for(var r=[],n=0;n<e.length;n++){for(var i=e[n],a=[],o=i.length,v=i[o-1][0],h=i[o-1][1],u=0,l=0;l<o;l++){var f=i[l][0],s=i[l][1],x=f-v,c=s-h;(u+=Math.sqrt(x*x+c*c))>t&&(a.push(i[l]),u=0),v=f,h=s}a.length>=3&&r.push(a)}return r.length>0?r:null}function he(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n];(i=V(i,t,!0)).length>=3&&r.push(i)}return r.length>0?r:null}function ue(e,t,r){for(var n=0;n<e.length;n++)t[0]=Math.min(e[n][0],t[0]),t[1]=Math.min(e[n][1],t[1]),r[0]=Math.max(e[n][0],r[0]),r[1]=Math.max(e[n][1],r[1])}var le={x:0,y:0},fe={x:0,y:0};function se(e,t,r,n){for(var i=e.length,a=0;a<i;a++){var o=e[a].data;t=e[a].center||t;for(var v=0,h=o.length;v<h;v++)for(var u=o[v],l=0,f=u.length;l<f;l++)e[a].data[v][l]=xe(u[l],t,r,n)}}function xe(e,t,r,n){for(var i,a=[],o=0,v=(i=r?new Float64Array(e):new Float32Array(e)).length;o<v;o+=2){var h=i[o],u=i[o+1];if(t&&r&&n){le.x=h,le.y=u;var l=be(le,fe);le.x=l.x,le.y=l.y,h=(l=we(n,le,r,fe)).x,u=l.y,h-=t[0],u-=t[1]}a.push([h,u])}return a}function ce(e,t){void 0===t&&(t=!1);for(var r=e.length,n=[],i=[],a=0,o=0;o<r;o++){var v=t?de(e[o]):pe(e[o]),h=e[o].bottomHeight||0,u=v.position;i.push(v);var l=u.length/3;n[o]={position:{middleZ:h+(e[o].height||0)/2,count:l,start:a,end:a+3*l},hide:!1},a+=3*l}var f=function(e){for(var t={},r={},n=0;n<e.length;++n){var i=e[n];for(var a in i)void 0===t[a]&&(t[a]=[],r[a]=0),t[a].push(i[a]),r[a]+=i[a].length}var o={},v=0,h=[];for(var u in t)if("indices"===u)for(var l=t[u],f=0,s=l.length;f<s;f++){for(var x=l[f],c=0,p=x.length;c<p;c++)h.push(x[c]+v);v+=t.position[f].length/3}else{var d=ge(t[u],r[u]);if(!d)return null;o[u]=d}return o.indices=new Uint32Array(h),o}(i),s=f.position,x=f.normal,c=f.uv,p=f.indices;return{position:s.buffer,normal:x.buffer,uv:c.buffer,indices:p.buffer,geometriesAttributes:n}}function pe(e){var t=e.data,r=e.height,n=e.bottomHeight,i=function(e,t){t=Object.assign({},t);for(var r=[1/0,1/0],n=[-1/0,-1/0],i=0;i<e.length;i++)ue(e[i][0],r,n);t.boundingRect=t.boundingRect||{x:r[0],y:r[1],width:n[0]-r[0],height:n[1]-r[1]},$(t);for(var a=[],o=t.translate||[0,0],v=t.scale||[1,1],h=t.boundingRect,u={x:h.x*v[0]+o[0],y:h.y*v[1]+o[1],width:h.width*v[0],height:h.height*v[1]},l=Math.min(h.width,h.height)/1e5,f=0;f<e.length;f++){var s=ve(e[f],l);if(s){var x=t.simplify/Math.max(v[0],v[1]);if(x>0&&(s=he(s,x)),s){for(var c=R.flatten(s),p=c.vertices,d=c.holes,g=c.dimensions,y=0;y<p.length;)p[y]=p[y++]*v[0]+o[0],p[y]=p[y++]*v[1]+o[1];if(Y(p,d),2!==g)throw new Error("Only 2D polygon points are supported");var m=t.bevelSize>0?Q(p,d,t.bevelSize,null,!0):p,M=D(m,d,g),b=ie(p,d,t.smoothSide,t.smoothSideThreshold);a.push({indices:M,vertices:b.vertices,rawVertices:p,topVertices:m,holes:b.holes,splittedMap:b.splittedMap,rect:u,depth:"function"==typeof t.depth?t.depth(f):t.depth})}}}return ae(a,t)}(t,{depth:r}),a=i.position,o=i.normal,v=i.uv,h=i.indices;return ye(a,n),{position:a,normal:o,uv:v,indices:h}}function de(e){var t=e.data,r=e.height,n=e.width,i=e.bottomHeight,a=function(e,t){t=Object.assign({},t);for(var r=[1/0,1/0],n=[-1/0,-1/0],i=0;i<e.length;i++)ue(e[i],r,n);t.boundingRect=t.boundingRect||{x:r[0],y:r[1],width:n[0]-r[0],height:n[1]-r[1]},$(t);var a=t.scale||[1,1];null==t.lineWidth&&(t.lineWidth=1),null==t.miterLimit&&(t.miterLimit=2);for(var o=[],v=0;v<e.length;v++){var h=e[v],u=t.simplify/Math.max(a[0],a[1]);u>0&&(h=V(h,u,!0)),o.push(oe(h,v,t))}return ae(o,t)}(t,{lineWidth:n,depth:r}),o=a.position,v=a.normal,h=a.uv,u=a.indices;return ye(o,i),{position:o,normal:v,uv:h,indices:u}}function ge(e,t){for(var r=new Float32Array(t),n=0,i=0;i<e.length;++i)r.set(e[i],n),n+=e[i].length;return r}function ye(e,t){if(void 0!==t&&"number"==typeof t&&0!==t)for(var r=0,n=e.length;r<n;r+=3)e[r+2]+=t}var me=Math.PI/180,Me=6378137*Math.PI/180;function be(e,t){var r,n=85.0511287798,i=e.x,a=Math.max(Math.min(n,e.y),-n);r=0===a?0:Math.log(Math.tan((90+a)*me/2))/me;var o=i*Me,v=r*Me;return t?(t.x=o,t.y=v,t):{x:o,y:v}}function we(e,t,r,n){var i=e[0]*(t.x-e[2])/r,a=-e[1]*(t.y-e[3])/r;return n?(n.x=i,n.y=a,n):{x:i,y:a}}function Se(e){void 0===e&&(e=[]);for(var t=e.length,r=new Float32Array(3*t),n=0;n<t;n++){var i=e[n],a=3*n;r[a]=i[0],r[a+1]=i[1]}return r}function Ze(e){for(var t=new Float32Array(2*e.length-6),r=0,n=0,i=e.length/3;n<i;n++){var a=e[3*n],o=e[3*n+1],v=e[3*n+2];if(n>0&&n<i-1){var h=3*r;t[h]=a,t[h+1]=o,t[h+2]=v,r++}var u=3*r;t[u]=a,t[u+1]=o,t[u+2]=v,r++}return t}function Ae(e){var t=0,r=e.length;if(1===r)return e[0];for(var n=0;n<r;n++)t+=e[n].length;for(var i=new Float32Array(t),a=0,o=0;o<r;o++)i.set(e[o],a),a+=e[o].length;return i}e.initialize=function(){},e.onmessage=function(e,t){var r=e.data,n=r.type,i=r.datas,a=r.glRes,o=r.matrix,v=r.center;if("ExtrudePolygons"===n){se(i,v,a,o);var h=ce(i);t(null,h,[h.position,h.normal,h.uv,h.indices])}else if("ExtrudeLines"===n){for(var u=0,l=i.length;u<l;u++)for(var f=0,s=i[u].data.length;f<s;f++)i[u].data[f]=xe(i[u].data[f],i[u].center||v,a,o);var x=ce(i,!0);t(null,x,[x.position,x.normal,x.uv,x.indices])}else if("ExtrudePolygon"===n){var c=[],p=[];i.forEach((function(e){var t=[e];se(t,v,a,o);var r=ce(t),n=r.position,i=r.normal,h=r.uv,u=r.indices;c.push({id:e.id,position:n,normal:i,uv:h,indices:u}),p.push(n,i,h,u)})),t(null,c,p)}else if("Line"===n||"FatLine"===n){for(var d=[],g=[],y=0,m=i.length;y<m;y++){for(var M=[],b=0,w=i[y].data.length;b<w;b++){i[y].data[b]=xe(i[y].data[b],i[y].center||v,a,o);var S=Se(i[y].data[b]);M.push(Ze(S))}var Z=Ae(M);ye(Z,i[y].bottomHeight),d.push({id:i[y].id,position:Z.buffer}),g.push(Z.buffer)}t(null,d,g)}else if("Lines"===n||"FatLines"===n){for(var A=0,z=[],F=[],R=0,q=[],P=0,L=i.length;P<L;P++){for(var V=0,B=0,E=i[P].data.length;B<E;B++){i[P].data[B]=xe(i[P].data[B],i[P].center||v,a,o);var U=Se(i[P].data[B]);ye(U,i[P].bottomHeight),V+=U.length/3*2-2,q.push(Ze(U))}var H=V;z[P]=[A,A+H],A+=H,F[P]={position:{count:V,start:R,end:R+3*V},hide:!1},"FatLines"===n&&(F[P].instanceStart={count:V,start:R,end:R+3*V},F[P].instanceEnd={count:V,start:R,end:R+3*V}),R+=3*V}var I=Ae(q);t(null,{id:i.id,position:I.buffer,geometriesAttributes:F,faceMap:z},[I.buffer])}else if("ExtrudeLine"===n){for(var O=0,T=i.length;O<T;O++)for(var W=0,j=i[O].data.length;W<j;W++)i[O].data[W]=xe(i[O].data[W],i[O].center||v,a,o);var k=[],_=[];i.forEach((function(e){var t=ce([e],!0),r=t.position,n=t.normal,i=t.uv,a=t.indices;k.push({id:e.id,position:r,normal:n,uv:i,indices:a}),_.push(r,n,i,a)})),t(null,k,_)}},Object.defineProperty(e,"__esModule",{value:!0})})`;
const workerName = '__maptalks.three__';

export function getWorkerName() {
    return workerName;
}

export function getWorkerCode() {
    return workerCode;
}
